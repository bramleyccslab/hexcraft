df$li[i]<-.01
if(df$a[i]==0)
{
df$li[i]<-1
}
if(df$a[i]==1 & df$d1[i]==1 & df$d2[i]==1 & df$d3[i]==1 & df$d4[i]==1)
{
df$li[i]<-1
}
if(df$a[i]==1 & df$d1[i]==0 & df$d2[i]==0 & df$d3[i]==0 & df$d4[i]==0)
{
df$li[i]<-1
}
}
df$li[df$a==1]/sum(df$li[df$a==1])
df$li[df$a==0]/sum(df$li[df$a==0])
df
df$li[df$a==1]<-df$li[df$a==1]/sum(df$li[df$a==1])
df$li[df$a==0]<-df$li[df$a==0]/sum(df$li[df$a==0])
library(tidyverse)
library(ggplot2)
library(emdist)
rm(list=ls())
df<-expand.grid(list(c(0,1),c(0,1),c(0,1),c(0,1), c(0,1),NA))
names(df)<-c('a','d1','d2','d3','d4','li')
for (i in 1:nrow(df))
{
df$li[i]<-.01
if(df$a[i]==0)
{
df$li[i]<-1
}
if(df$a[i]==1 & df$d1[i]==1 & df$d2[i]==1 & df$d3[i]==1 & df$d4[i]==1)
{
df$li[i]<-1
}
if(df$a[i]==1 & df$d1[i]==0 & df$d2[i]==0 & df$d3[i]==0 & df$d4[i]==0)
{
df$li[i]<-1
}
}
df$li[df$a==1]<-df$li[df$a==1]/sum(df$li[df$a==1])
df$li[df$a==0]<-df$li[df$a==0]/sum(df$li[df$a==0])
df
sum(df)
sum(df$li)
li_a_d1<- c(sum(df$li[df$d1==1 & df$a==0]), sum(df$li[df$d1==1 & df$a==1]))
li_a_d1<- c(sum(df$li[df$d1==1 & df$a==0]), sum(df$li[df$d1==1 & df$a==1]))
li_a_d1d2d3d4<- c(sum(df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==0]), sum(df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==1])))
df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==0]
f$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==1]
df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==1]
li_a_d1d2d3d4<- c(sum(df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==0]), sum(df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==1])))
library(tidyverse)
library(ggplot2)
library(emdist)
rm(list=ls())
df<-expand.grid(list(c(0,1),c(0,1),c(0,1),c(0,1), c(0,1),NA))
names(df)<-c('a','d1','d2','d3','d4','li')
for (i in 1:nrow(df))
{
df$li[i]<-.01
if(df$a[i]==0)
{
df$li[i]<-1
}
if(df$a[i]==1 & df$d1[i]==1 & df$d2[i]==1 & df$d3[i]==1 & df$d4[i]==1)
{
df$li[i]<-1
}
if(df$a[i]==1 & df$d1[i]==0 & df$d2[i]==0 & df$d3[i]==0 & df$d4[i]==0)
{
df$li[i]<-1
}
}
df$li[df$a==0]<-df$li[df$a==0]/sum(df$li[df$a==0])
li_a_d1<- c(sum(df$li[df$d1==1 & df$a==0]), sum(df$li[df$d1==1 & df$a==1]))
li_a_d1d2d3d4<- c(sum(df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==0]), sum(df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==1])))
li_a_d1d2d3d4<- c(sum(df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==0]), sum(df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==1]))
df<-expand.grid(list(c(0,1),c(0,1),c(0,1),c(0,1), c(0,1),NA))
names(df)<-c('a','d1','d2','d3','d4','li')
for (i in 1:nrow(df))
{
df$li[i]<-.01
if(df$a[i]==0)
{
df$li[i]<-1
}
if(df$a[i]==1 & df$d1[i]==1 & df$d2[i]==1 & df$d3[i]==1 & df$d4[i]==1)
{
df$li[i]<-1
}
if(df$a[i]==1 & df$d1[i]==0 & df$d2[i]==0 & df$d3[i]==0 & df$d4[i]==0)
{
df$li[i]<-1
}
}
df$li[df$a==1]<-df$li[df$a==1]/sum(df$li[df$a==1])
df$li[df$a==0]<-df$li[df$a==0]/sum(df$li[df$a==0])
li_a_d1<- c(sum(df$li[df$d1==1 & df$a==0]), sum(df$li[df$d1==1 & df$a==1]))
li_a_d1d2d3d4<- c(sum(df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==0]), sum(df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==1]))
# li_a_d1d2d3d4<-c(df$li[df$c1==1 & df$c2==1& df$c3==1 & df$a==0],
#             df$li[df$c1==1 & df$c2==1& df$c3==1 & df$a==1])
#
# li_a_c1c2<-c(sum(df$li[df$c1==1 & df$c2==1 & df$a==0]),
#             sum(df$li[df$c1==1 & df$c2==1 & df$a==1]))
#
# li_a_d1<-c(sum(df$li[df$c3==1 & df$a==0]),
#             sum(df$li[df$c3==1 & df$a==1]))
# Evidential causal effect sizes for all three vs just first2
logodds_d1d2d3d4<-log2(matrix(c(1,li_a_d1d2d3d4[1]/li_a_d1d2d3d4[2], li_a_d1d2d3d4[2]/li_a_d1d2d3d4[1],1), 2,2, byrow=T))
# logodds_c1c2<-log2(matrix(c(1,li_a_c1c2[1]/li_a_c1c2[2], li_a_c1c2[2]/li_a_c1c2[1],1), 2,2, byrow=T))
logodds_d1<-log2(matrix(c(1,li_a_d1[1]/li_a_d1[2], li_a_d1[2]/li_a_d1[1],1), 2,2, byrow=T))
logodds_d1d2d3d4
# logodds_c1c2
logodds_d1
cbind(df$li[df$d1==1 & df$a==0], df$li[df$d1==1 & df$a==1])
log(cbind(df$li[df$d1==1 & df$a==0], df$li[df$d1==1 & df$a==1]))
tmp<-cbind(df$li[df$d1==1 & df$a==0], df$li[df$d1==1 & df$a==1])
tmp[,2]/tmp[,1]
log(tmp[,2]/tmp[,1])
mean(log(tmp[,2]/tmp[,1]))
cbind(log(tmp[,2]/tmp[,1]), log(tmp[,1]/tmp[,2]))
abs(log(tmp[,2]/tmp[,1]))
mean(abs(log(tmp[,2]/tmp[,1])))
li_a_d1d2d3d4<- c(sum(df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==0]), sum(df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==1]))
# So it does nothing alone, but across all the situations it could be in, if there were fully revealed, it would provide this much info:
tmp<-cbind(df$li[df$d1==1 & df$a==0], df$li[df$d1==1 & df$a==1])
abs(log(tmp[,2]/tmp[,1]))
mean(abs(log(tmp[,2]/tmp[,1])))
df$li[df$d1==1 & df$a==0]
df$li[df$d1==1 & df$a==1]
# So it does nothing alone, but across all the situations it could be in, if there were fully revealed, it would provide this much info:
tmp<-cbind(df$li[df$d1==1 & df$a==0], df$li[df$d1==1 & df$a==1], df$li[df$d1==0 & df$a==0, df$li[df$d1==0 & df$a==1]])
# So it does nothing alone, but across all the situations it could be in, if there were fully revealed, it would provide this much info:
tmp<-cbind(df$li[df$d1==1 & df$a==0], df$li[df$d1==1 & df$a==1], df$li[df$d1==0 & df$a==0], df$li[df$d1==0 & df$a==1]])
# So it does nothing alone, but across all the situations it could be in, if there were fully revealed, it would provide this much info:
tmp<-cbind(df$li[df$d1==1 & df$a==0], df$li[df$d1==1 & df$a==1], df$li[df$d1==0 & df$a==0], df$li[df$d1==0 & df$a==1])
tmp
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(emdist)
rm(list=ls())
df<-expand.grid(list(c(0,1),c(0,1),c(0,1),c(0,1), c(0,1),NA))
names(df)<-c('a','d1','d2','d3','d4','li')
for (i in 1:nrow(df))
{
df$li[i]<-.01
if(df$a[i]==0)
{
df$li[i]<-1
}
if(df$a[i]==1 & df$d1[i]==1 & df$d2[i]==1 & df$d3[i]==1 & df$d4[i]==1)
{
df$li[i]<-1
}
if(df$a[i]==1 & df$d1[i]==0 & df$d2[i]==0 & df$d3[i]==0 & df$d4[i]==0)
{
df$li[i]<-1
}
}
df$li[df$a==0]<-df$li[df$a==0]/sum(df$li[df$a==0])
li_a_d1<- c(sum(df$li[df$d1==1 & df$a==0]), sum(df$li[df$d1==1 & df$a==1]))
# So it does nothing alone, but across all the situations it could be in, if there were fully revealed, it would provide this much info:
tmp<-cbind(df$li[df$d1==1 & df$a==0], df$li[df$d1==1 & df$a==1], df$li[df$d1==0 & df$a==0], df$li[df$d1==0 & df$a==1])
abs(log(tmp[,2]/tmp[,1]))
mean(abs(log(tmp[,2]/tmp[,1])))
li_a_d1d2d3d4<- c(sum(df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==0]), sum(df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==1]))
# Evidential causal effect sizes for all three vs just first2
logodds_d1d2d3d4<-log2(matrix(c(1,li_a_d1d2d3d4[1]/li_a_d1d2d3d4[2], li_a_d1d2d3d4[2]/li_a_d1d2d3d4[1],1), 2,2, byrow=T))
# logodds_c1c2<-log2(matrix(c(1,li_a_c1c2[1]/li_a_c1c2[2], li_a_c1c2[2]/li_a_c1c2[1],1), 2,2, byrow=T))
logodds_d1<-log2(matrix(c(1,li_a_d1[1]/li_a_d1[2], li_a_d1[2]/li_a_d1[1],1), 2,2, byrow=T))
logodds_d1d2d3d4
# logodds_c1c2
logodds_d1
# Evidential causal effect sizes for all three vs just first2
logodds_d1d2d3d4<-log2(matrix(c(1,li_a_d1d2d3d4[1]/li_a_d1d2d3d4[2], li_a_d1d2d3d4[2]/li_a_d1d2d3d4[1],1), 2,2, byrow=T))
# logodds_c1c2<-log2(matrix(c(1,li_a_c1c2[1]/li_a_c1c2[2], li_a_c1c2[2]/li_a_c1c2[1],1), 2,2, byrow=T))
logodds_d1<-log2(matrix(c(1,li_a_d1[1]/li_a_d1[2], li_a_d1[2]/li_a_d1[1],1), 2,2, byrow=T))
logodds_d1d2d3d4
# logodds_c1c2
logodds_d1
li_a_d1d2d3d4
logodds_d1d2d3d4
exp(4)
exp(log2(5))
exp(log(5))
exp2(log2(5))
help(exp)
# Evidential causal effect sizes for all three vs just first2
logodds_d1d2d3d4<-log(matrix(c(1,li_a_d1d2d3d4[1]/li_a_d1d2d3d4[2], li_a_d1d2d3d4[2]/li_a_d1d2d3d4[1],1), 2,2, byrow=T))
# logodds_c1c2<-log2(matrix(c(1,li_a_c1c2[1]/li_a_c1c2[2], li_a_c1c2[2]/li_a_c1c2[1],1), 2,2, byrow=T))
logodds_d1<-log(matrix(c(1,li_a_d1[1]/li_a_d1[2], li_a_d1[2]/li_a_d1[1],1), 2,2, byrow=T))
logodds_d1d2d3d4
# logodds_c1c2
logodds_d1
exp(logodds_d1d2d3d4)
# logodds_c1c2
exp(logodds_d1)
# Assuming 0.5
posterior_d1d2d3d4<-li_a_d1d2d3d4*0.5/sum(li_a_d1d2d3d4*c(0.5,0.5))
# posterior_c1c2<-li_a_c1c2*0.5/sum(li_a_c1c2*c(0.5,0.5))
posterior_d1<-li_a_d1*0.5/sum(li_a_d1*c(0.5,0.5))
posterior_d1d2d3d4
posterior_c1c2
posterior_d1d2d3d4
posterior_d1
li_a_d1_notd2<- c(sum(df$li[df$d1==1 & df$d2==0 & df$a==0]), sum(df$li[df$d1==1 & df$d2==0 & df$a==1]))
logodds_d1_notd2<-log2(matrix(c(1,li_a_d1_notd2[1]/li_a_d1_notd2[2], li_a_d1_notd2[2]/li_a_d1_notd2[1],1), 2,2, byrow=T))
exp(logodds_d1_notd2)
# Assuming 0.5
posterior_d1d2d3d4<-li_a_d1d2d3d4*0.5/sum(li_a_d1d2d3d4*c(0.5,0.5))
posterior_d1_notd2<-li_a_d1_notd2*0.5/sum(li_a_d1_notd2*c(0.5,0.5))
posterior_d1<-li_a_d1*0.5/sum(li_a_d1*c(0.5,0.5))
posterior_d1d2d3d4
posterior_d1_notd2
li_a_d1d2d3d4<- c(sum(df$li[df$d1==0 & df$d2==0 & df$d3==0 & df$d4==0 & df$a==0]), sum(df$li[df$d1==0 & df$d2==0 & df$d3==0 & df$d4==0 & df$a==1]))
# li_a_d1d2d3d4<-c(df$li[df$c1==1 & df$c2==1& df$c3==1 & df$a==0],
#             df$li[df$c1==1 & df$c2==1& df$c3==1 & df$a==1])
#
# li_a_c1c2<-c(sum(df$li[df$c1==1 & df$c2==1 & df$a==0]),
#             sum(df$li[df$c1==1 & df$c2==1 & df$a==1]))
#
# li_a_d1<-c(sum(df$li[df$c3==1 & df$a==0]),
#             sum(df$li[df$c3==1 & df$a==1]))
# Evidential causal effect sizes for all three vs just first2
logodds_d1d2d3d4<-log(matrix(c(1,li_a_d1d2d3d4[1]/li_a_d1d2d3d4[2], li_a_d1d2d3d4[2]/li_a_d1d2d3d4[1],1), 2,2, byrow=T))
logodds_d1_notd2<-log2(matrix(c(1,li_a_d1_notd2[1]/li_a_d1_notd2[2], li_a_d1_notd2[2]/li_a_d1_notd2[1],1), 2,2, byrow=T))
logodds_d1<-log(matrix(c(1,li_a_d1[1]/li_a_d1[2], li_a_d1[2]/li_a_d1[1],1), 2,2, byrow=T))
exp(logodds_d1d2d3d4)
exp(logodds_d1_notd2)
# logodds_c1c2
exp(logodds_d1)
# Assuming 0.5
posterior_d1d2d3d4<-li_a_d1d2d3d4*0.5/sum(li_a_d1d2d3d4*c(0.5,0.5))
posterior_d1_notd2<-li_a_d1_notd2*0.5/sum(li_a_d1_notd2*c(0.5,0.5))
posterior_d1<-li_a_d1*0.5/sum(li_a_d1*c(0.5,0.5))
posterior_d1d2d3d4
posterior_d1_notd2
posterior_d1
li_a_d1<- c(sum(df$li[df$d1==0 & df$a==0]), sum(df$li[df$d1==0 & df$a==1]))
li_a_d1_notd2<- c(sum(df$li[df$d1==1 & df$d2==0 & df$a==0]), sum(df$li[df$d1==1 & df$d2==0 & df$a==1]))
# So it does nothing alone, but across all the situations it could be in, if there were fully revealed, it would provide this much info:
tmp<-cbind(df$li[df$d1==1 & df$a==0], df$li[df$d1==1 & df$a==1], df$li[df$d1==0 & df$a==0], df$li[df$d1==0 & df$a==1])
abs(log(tmp[,2]/tmp[,1]))
mean(abs(log(tmp[,2]/tmp[,1])))
li_a_d1d2d3d4<- c(sum(df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==0]), sum(df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==1]))
li_a_d1d2d3d4<- c(sum(df$li[df$d1==0 & df$d2==0 & df$d3==0 & df$d4==0 & df$a==0]), sum(df$li[df$d1==0 & df$d2==0 & df$d3==0 & df$d4==0 & df$a==1]))
# Evidential causal effect sizes for all three vs just first2
logodds_d1d2d3d4<-log(matrix(c(1,li_a_d1d2d3d4[1]/li_a_d1d2d3d4[2], li_a_d1d2d3d4[2]/li_a_d1d2d3d4[1],1), 2,2, byrow=T))
logodds_d1_notd2<-log2(matrix(c(1,li_a_d1_notd2[1]/li_a_d1_notd2[2], li_a_d1_notd2[2]/li_a_d1_notd2[1],1), 2,2, byrow=T))
logodds_d1<-log(matrix(c(1,li_a_d1[1]/li_a_d1[2], li_a_d1[2]/li_a_d1[1],1), 2,2, byrow=T))
exp(logodds_d1d2d3d4)
exp(logodds_d1_notd2)
# logodds_c1c2
exp(logodds_d1)
# Assuming 0.5
posterior_d1d2d3d4<-li_a_d1d2d3d4*0.5/sum(li_a_d1d2d3d4*c(0.5,0.5))
posterior_d1_notd2<-li_a_d1_notd2*0.5/sum(li_a_d1_notd2*c(0.5,0.5))
posterior_d1<-li_a_d1*0.5/sum(li_a_d1*c(0.5,0.5))
posterior_d1d2d3d4
posterior_d1<-li_a_d1*0.5/sum(li_a_d1*c(0.5,0.5))
posterior_d1d2d3d4
posterior_d1_notd2
posterior_d1
df<-expand.grid(list(c(0,1),c(0,1),c(0,1),c(0,1), c(0,1),NA))
names(df)<-c('a','d1','d2','d3','d4','li')
for (i in 1:nrow(df))
{
df$li[i]<-.01
if(df$a[i]==0)
{
df$li[i]<-1
}
if(df$a[i]==1 & df$d1[i]==1 & df$d2[i]==1 & df$d3[i]==1 & df$d4[i]==1)
{
df$li[i]<-1
}
if(df$a[i]==1 & df$d1[i]==0 & df$d2[i]==0 & df$d3[i]==0 & df$d4[i]==0)
{
df$li[i]<-1
}
}
df$li[df$a==1]<-df$li[df$a==1]/sum(df$li[df$a==1])
df$li[df$a==0]<-df$li[df$a==0]/sum(df$li[df$a==0])
li_a_d1<- c(sum(df$li[df$d1==0 & df$a==0]), sum(df$li[df$d1==0 & df$a==1]))
li_a_d1_notd2<- c(sum(df$li[df$d1==1 & df$d2==0 & df$a==0]), sum(df$li[df$d1==1 & df$d2==0 & df$a==1]))
# So it does nothing alone, but across all the situations it could be in, if there were fully revealed, it would provide this much info:
tmp<-cbind(df$li[df$d1==1 & df$a==0], df$li[df$d1==1 & df$a==1], df$li[df$d1==0 & df$a==0], df$li[df$d1==0 & df$a==1])
abs(log(tmp[,2]/tmp[,1]))
mean(abs(log(tmp[,2]/tmp[,1])))
li_a_d1d2d3d4<- c(sum(df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==0]), sum(df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==1]))
li_a_d1d2d3d4<- c(sum(df$li[df$d1==0 & df$d2==0 & df$d3==0 & df$d4==0 & df$a==0]), sum(df$li[df$d1==0 & df$d2==0 & df$d3==0 & df$d4==0 & df$a==1]))
# li_a_d1d2d3d4<-c(df$li[df$c1==1 & df$c2==1& df$c3==1 & df$a==0],
#             df$li[df$c1==1 & df$c2==1& df$c3==1 & df$a==1])
#
# li_a_c1c2<-c(sum(df$li[df$c1==1 & df$c2==1 & df$a==0]),
#             sum(df$li[df$c1==1 & df$c2==1 & df$a==1]))
#
# li_a_d1<-c(sum(df$li[df$c3==1 & df$a==0]),
#             sum(df$li[df$c3==1 & df$a==1]))
# Evidential causal effect sizes for all three vs just first2
logodds_d1d2d3d4<-log(matrix(c(1,li_a_d1d2d3d4[1]/li_a_d1d2d3d4[2], li_a_d1d2d3d4[2]/li_a_d1d2d3d4[1],1), 2,2, byrow=T))
logodds_d1_notd2<-log2(matrix(c(1,li_a_d1_notd2[1]/li_a_d1_notd2[2], li_a_d1_notd2[2]/li_a_d1_notd2[1],1), 2,2, byrow=T))
logodds_d1<-log(matrix(c(1,li_a_d1[1]/li_a_d1[2], li_a_d1[2]/li_a_d1[1],1), 2,2, byrow=T))
exp(logodds_d1d2d3d4)
exp(logodds_d1_notd2)
# logodds_c1c2
exp(logodds_d1)
# Assuming 0.5
posterior_d1d2d3d4<-li_a_d1d2d3d4*0.5/sum(li_a_d1d2d3d4*c(0.5,0.5))
posterior_d1_notd2<-li_a_d1_notd2*0.5/sum(li_a_d1_notd2*c(0.5,0.5))
posterior_d1<-li_a_d1*0.5/sum(li_a_d1*c(0.5,0.5))
posterior_d1d2d3d4
posterior_d1_notd2
posterior_d1
df<-expand.grid(list(c(0,1),c(0,1),c(0,1),c(0,1), c(0,1),NA))
names(df)<-c('a','d1','d2','d3','d4','li')
for (i in 1:nrow(df))
{
df$li[i]<-.01
if(df$a[i]==0)
{
df$li[i]<-1
}
if(df$a[i]==1 & df$d1[i]==1 & df$d2[i]==1 & df$d3[i]==1 & df$d4[i]==1)
{
df$li[i]<-1
}
if(df$a[i]==1 & df$d1[i]==0 & df$d2[i]==0 & df$d3[i]==0 & df$d4[i]==0)
{
df$li[i]<-1
}
}
df$li[df$a==1]<-df$li[df$a==1]/sum(df$li[df$a==1])
df$li[df$a==0]<-df$li[df$a==0]/sum(df$li[df$a==0])
li_a_d1<- c(sum(df$li[df$d1==0 & df$a==0]), sum(df$li[df$d1==0 & df$a==1]))
li_a_d1_notd2<- c(sum(df$li[df$d1==1 & df$d2==0 & df$a==0]), sum(df$li[df$d1==1 & df$d2==0 & df$a==1]))
# So it does nothing alone, but across all the situations it could be in, if there were fully revealed, it would provide this much info:
tmp<-cbind(df$li[df$d1==1 & df$a==0], df$li[df$d1==1 & df$a==1], df$li[df$d1==0 & df$a==0], df$li[df$d1==0 & df$a==1])
abs(log(tmp[,2]/tmp[,1]))
mean(abs(log(tmp[,2]/tmp[,1])))
li_a_d1d2d3d4<- c(sum(df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==0]), sum(df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==1]))
li_a_d1d2d3d4<- c(sum(df$li[df$d1==0 & df$d2==0 & df$d3==0 & df$d4==0 & df$a==0]), sum(df$li[df$d1==0 & df$d2==0 & df$d3==0 & df$d4==0 & df$a==1]))
# li_a_d1d2d3d4<-c(df$li[df$c1==1 & df$c2==1& df$c3==1 & df$a==0],
#             df$li[df$c1==1 & df$c2==1& df$c3==1 & df$a==1])
#
# li_a_c1c2<-c(sum(df$li[df$c1==1 & df$c2==1 & df$a==0]),
#             sum(df$li[df$c1==1 & df$c2==1 & df$a==1]))
#
# li_a_d1<-c(sum(df$li[df$c3==1 & df$a==0]),
#             sum(df$li[df$c3==1 & df$a==1]))
# Evidential causal effect sizes for all three vs just first2
logodds_d1d2d3d4<-log(matrix(c(1,li_a_d1d2d3d4[1]/li_a_d1d2d3d4[2], li_a_d1d2d3d4[2]/li_a_d1d2d3d4[1],1), 2,2, byrow=T))
logodds_d1_notd2<-log2(matrix(c(1,li_a_d1_notd2[1]/li_a_d1_notd2[2], li_a_d1_notd2[2]/li_a_d1_notd2[1],1), 2,2, byrow=T))
logodds_d1<-log(matrix(c(1,li_a_d1[1]/li_a_d1[2], li_a_d1[2]/li_a_d1[1],1), 2,2, byrow=T))
exp(logodds_d1d2d3d4)
exp(logodds_d1_notd2)
# logodds_c1c2
exp(logodds_d1)
# Assuming 0.5
posterior_d1d2d3d4<-li_a_d1d2d3d4*0.5/sum(li_a_d1d2d3d4*c(0.5,0.5))
posterior_d1_notd2<-li_a_d1_notd2*0.5/sum(li_a_d1_notd2*c(0.5,0.5))
posterior_d1<-li_a_d1*0.5/sum(li_a_d1*c(0.5,0.5))
posterior_d1d2d3d4
posterior_d1_notd2
posterior_d1
# pD<-pD2<-pD3<-pD4<-c(.2,.8)#Source reliable p(no, yes) for witnesses 1,2,3
# pA<-c(.5,.5)#Prior on alleged offence p(no, yes)
# SEM function
# witness<-function(crime,credibility){(crime&credibility) | ((!crime)&(!credibility))}
df<-expand.grid(list(c(0,1),c(0,1),c(0,1),c(0,1), c(0,1),NA))
names(df)<-c('a','d1','d2','d3','d4','li')
for (i in 1:nrow(df))
{
df$li[i]<-.01
if(df$a[i]==0)
{
df$li[i]<-1
}
if(df$a[i]==1 & df$d1[i]==1 & df$d2[i]==1 & df$d3[i]==1 & df$d4[i]==1)
{
df$li[i]<-1
}
if(df$a[i]==1 & df$d1[i]==0 & df$d2[i]==0 & df$d3[i]==0 & df$d4[i]==0)
{
df$li[i]<-1
}
}
df$li[df$a==1]<-df$li[df$a==1]/sum(df$li[df$a==1])
df$li[df$a==0]<-df$li[df$a==0]/sum(df$li[df$a==0])
li_a_d1<- c(sum(df$li[df$d1==1 & df$a==0]), sum(df$li[df$d1==1 & df$a==1]))
li_a_d1_notd2<- c(sum(df$li[df$d1==1 & df$d2==0 & df$a==0]), sum(df$li[df$d1==1 & df$d2==0 & df$a==1]))
# So it does nothing alone, but across all the situations it could be in, if there were fully revealed, it would provide this much info:
tmp<-cbind(df$li[df$d1==1 & df$a==0], df$li[df$d1==1 & df$a==1], df$li[df$d1==0 & df$a==0], df$li[df$d1==0 & df$a==1])
abs(log(tmp[,2]/tmp[,1]))
mean(abs(log(tmp[,2]/tmp[,1])))
li_a_d1d2d3d4<- c(sum(df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==0]), sum(df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==1]))
li_a_d1d2d3d4<- c(sum(df$li[df$d1==0 & df$d2==0 & df$d3==0 & df$d4==0 & df$a==0]), sum(df$li[df$d1==0 & df$d2==0 & df$d3==0 & df$d4==0 & df$a==1]))
# li_a_d1d2d3d4<-c(df$li[df$c1==1 & df$c2==1& df$c3==1 & df$a==0],
#             df$li[df$c1==1 & df$c2==1& df$c3==1 & df$a==1])
#
# li_a_c1c2<-c(sum(df$li[df$c1==1 & df$c2==1 & df$a==0]),
#             sum(df$li[df$c1==1 & df$c2==1 & df$a==1]))
#
# li_a_d1<-c(sum(df$li[df$c3==1 & df$a==0]),
#             sum(df$li[df$c3==1 & df$a==1]))
# Evidential causal effect sizes for all three vs just first2
logodds_d1d2d3d4<-log(matrix(c(1,li_a_d1d2d3d4[1]/li_a_d1d2d3d4[2], li_a_d1d2d3d4[2]/li_a_d1d2d3d4[1],1), 2,2, byrow=T))
logodds_d1_notd2<-log2(matrix(c(1,li_a_d1_notd2[1]/li_a_d1_notd2[2], li_a_d1_notd2[2]/li_a_d1_notd2[1],1), 2,2, byrow=T))
logodds_d1<-log(matrix(c(1,li_a_d1[1]/li_a_d1[2], li_a_d1[2]/li_a_d1[1],1), 2,2, byrow=T))
exp(logodds_d1d2d3d4)
exp(logodds_d1_notd2)
# logodds_c1c2
exp(logodds_d1)
# Assuming 0.5
posterior_d1d2d3d4<-li_a_d1d2d3d4*0.5/sum(li_a_d1d2d3d4*c(0.5,0.5))
posterior_d1_notd2<-li_a_d1_notd2*0.5/sum(li_a_d1_notd2*c(0.5,0.5))
posterior_d1<-li_a_d1*0.5/sum(li_a_d1*c(0.5,0.5))
posterior_d1d2d3d4
posterior_d1_notd2
posterior_d1
exp(logodds_d1)
abs(log(tmp[,2]/tmp[,1]))
# So it does nothing alone, but across all the situations it could be in, if they were fully revealed, it would provide this much info:
tmp<-cbind(df$li[df$d1==1 & df$a==0], df$li[df$d1==1 & df$a==1], df$li[df$d1==0 & df$a==0], df$li[df$d1==0 & df$a==1])
# So it does nothing alone, but across all the situations it could be in, if they were fully revealed, it would provide this much info:
tmp<-cbind(df$li[df$d1==1 & df$a==0], df$li[df$d1==1 & df$a==1], df$li[df$d1==0 & df$a==0], df$li[df$d1==0 & df$a==1])
# pD<-pD2<-pD3<-pD4<-c(.2,.8)#Source reliable p(no, yes) for witnesses 1,2,3
# pA<-c(.5,.5)#Prior on alleged offence p(no, yes)
# SEM function
# witness<-function(crime,credibility){(crime&credibility) | ((!crime)&(!credibility))}
df<-expand.grid(list(c(0,1),c(0,1),c(0,1),c(0,1), c(0,1),NA))
names(df)<-c('a','d1','d2','d3','d4','li')
for (i in 1:nrow(df))
{
df$li[i]<-.01
if(df$a[i]==0)
{
df$li[i]<-1
}
if(df$a[i]==1 & df$d1[i]==1 & df$d2[i]==1 & df$d3[i]==1 & df$d4[i]==1)
{
df$li[i]<-1
}
if(df$a[i]==1 & df$d1[i]==0 & df$d2[i]==0 & df$d3[i]==0 & df$d4[i]==0)
{
df$li[i]<-1
}
}
df$li[df$a==1]<-df$li[df$a==1]/sum(df$li[df$a==1])
df$li[df$a==0]<-df$li[df$a==0]/sum(df$li[df$a==0])
li_a_d1<- c(sum(df$li[df$d1==1 & df$a==0]), sum(df$li[df$d1==1 & df$a==1]))
li_a_d1_notd2<- c(sum(df$li[df$d1==1 & df$d2==0 & df$a==0]), sum(df$li[df$d1==1 & df$d2==0 & df$a==1]))
li_a_d1d2d3d4<- c(sum(df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==0]), sum(df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==1]))
li_a_d1d2d3d4<- c(sum(df$li[df$d1==0 & df$d2==0 & df$d3==0 & df$d4==0 & df$a==0]), sum(df$li[df$d1==0 & df$d2==0 & df$d3==0 & df$d4==0 & df$a==1]))
# Evidential causal effects for different evidence combos
logodds_d1d2d3d4<-log(matrix(c(1,li_a_d1d2d3d4[1]/li_a_d1d2d3d4[2], li_a_d1d2d3d4[2]/li_a_d1d2d3d4[1],1), 2,2, byrow=T))
logodds_d1_notd2<-log2(matrix(c(1,li_a_d1_notd2[1]/li_a_d1_notd2[2], li_a_d1_notd2[2]/li_a_d1_notd2[1],1), 2,2, byrow=T))
logodds_d1<-log(matrix(c(1,li_a_d1[1]/li_a_d1[2], li_a_d1[2]/li_a_d1[1],1), 2,2, byrow=T))
exp(logodds_d1d2d3d4)
exp(logodds_d1_notd2)
exp(logodds_d1)
# Assuming 0.5
posterior_d1d2d3d4<-li_a_d1d2d3d4*0.5/sum(li_a_d1d2d3d4*c(0.5,0.5))
posterior_d1_notd2<-li_a_d1_notd2*0.5/sum(li_a_d1_notd2*c(0.5,0.5))
posterior_d1<-li_a_d1*0.5/sum(li_a_d1*c(0.5,0.5))
posterior_d1d2d3d4
posterior_d1_notd2
posterior_d1
# So it does nothing alone, but across all the situations it could be in, if they were fully revealed, it would provide this much info:
tmp<-cbind(df$li[df$d1==1 & df$a==0], df$li[df$d1==1 & df$a==1], df$li[df$d1==0 & df$a==0], df$li[df$d1==0 & df$a==1])
abs(log(tmp[,2]/tmp[,1]))
mean(abs(log(tmp[,2]/tmp[,1])))
tmp
# So it does nothing alone, but across all the situations it could be in, if they were fully revealed, it would provide this much info:
tmp<-cbind(df$li[df$d1==1 & df$a==0], df$li[df$d1==1 & df$a==1],)# df$li[df$d1==0 & df$a==0], df$li[df$d1==0 & df$a==1])
# So it does nothing alone, but across all the situations it could be in, if they were fully revealed, it would provide this much info:
tmp<-cbind(df$li[df$d1==1 & df$a==0], df$li[df$d1==1 & df$a==1])# df$li[df$d1==0 & df$a==0], df$li[df$d1==0 & df$a==1])
tmp
abs(log(tmp[,2]/tmp[,1]))
library(tidyverse)
library(ggplot2)
library(emdist)
rm(list=ls())
# Define a possibility space where a is the the defendent 1=guilty, 0=innocent, d1 to d4 can take the values 0 or 1
df<-expand.grid(list(c(0,1),c(0,1),c(0,1),c(0,1), c(0,1),NA))
names(df)<-c('a','d1','d2','d3','d4','li')
df$li<-.01
df$li[df$a==0]<-1
df$li[df$a==1 & df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1]<-1
df$li[df$a==1]<-df$li[df$a==1]/sum(df$li[df$a==1])
df$li[df$a==0]<-df$li[df$a==0]/sum(df$li[df$a==0])
# Evidential causal effects for different evidence combos
li_a_d1<- c(sum(df$li[df$d1==1 & df$a==0]), sum(df$li[df$d1==1 & df$a==1]))
li_a_d1_notd2<- c(sum(df$li[df$d1==1 & df$d2==0 & df$a==0]), sum(df$li[df$d1==1 & df$d2==0 & df$a==1]))
li_a_d1d2d3d4<- c(sum(df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==0]), sum(df$li[df$d1==1 & df$d2==1 & df$d3==1 & df$d4==1 & df$a==1]))
li_a_d1d2d3d4<- c(sum(df$li[df$d1==0 & df$d2==0 & df$d3==0 & df$d4==0 & df$a==0]), sum(df$li[df$d1==0 & df$d2==0 & df$d3==0 & df$d4==0 & df$a==1]))
# Express as matrices
logodds_d1d2d3d4<-log(matrix(c(1,li_a_d1d2d3d4[1]/li_a_d1d2d3d4[2], li_a_d1d2d3d4[2]/li_a_d1d2d3d4[1],1), 2,2, byrow=T))
logodds_d1_notd2<-log2(matrix(c(1,li_a_d1_notd2[1]/li_a_d1_notd2[2], li_a_d1_notd2[2]/li_a_d1_notd2[1],1), 2,2, byrow=T))
logodds_d1<-log(matrix(c(1,li_a_d1[1]/li_a_d1[2], li_a_d1[2]/li_a_d1[1],1), 2,2, byrow=T))
exp(logodds_d1d2d3d4)
exp(logodds_d1_notd2)
exp(logodds_d1)
sum(df$li)
df
li_a_notd1d2d3d4<- c(sum(df$li[df$d1==0 & df$d2==0 & df$d3==0 & df$d4==0 & df$a==0]), sum(df$li[df$d1==0 & df$d2==0 & df$d3==0 & df$d4==0 & df$a==1]))
---
title: "Evidential value when coherence is at stake"
1500+1443.21+185+220
